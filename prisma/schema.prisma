// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                     Int           @id @default(autoincrement())
  corporateAccountNumber String
  corporateName          String
  userId                 String        @unique
  username               String        @unique
  role                   Role
  phoneNumber            String
  email                  String        @unique
  password               String
  createdAt              DateTime      @default(now())
  updatedAt              DateTime      @updatedAt
  transactions           Transaction[] @relation("UserTransactions")
}

model Transaction {
  id                  Int                 @id @default(autoincrement())
  referenceNo         String              @unique
  totalTransferAmount Float
  totalTransferRecord Int
  fromAccountNumber   String
  transferDate        DateTime
  role                Role
  submitDateTime      DateTime            @default(now())
  instructionType     InstructionType
  makerUsername       String
  transferType        TransferType
  status              Status
  userId              Int
  user                User                @relation("UserTransactions", fields: [userId], references: [id])
  transactionDetails  TransactionDetail[]
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
}

model TransactionDetail {
  id            Int         @id @default(autoincrement())
  transactionId Int
  transaction   Transaction @relation(fields: [transactionId], references: [id])
  accountNumber String
  accountBank   String
  accountName   String
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
}

enum Role {
  MAKER
  APPROVER
}

enum InstructionType {
  IMMEDIATE
  STANDING_INSTRUCTION
}

enum TransferType {
  ONLINE
  OFFLINE
}

enum Status {
  AWAITING_APPROVAL
  APPROVED
  REJECTED
}
